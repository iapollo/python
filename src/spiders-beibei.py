# -*-coding:utf-8-*-import urllib2import urllibimport jsonimport timeimport randomimport sys'''crawler function'''def crawler_beibei(password, username):    # headers    user_agent = 'BranchWork/3.6.3 (iPhone; iOS 8.3; Scale/3.00)'    content_type = 'application/x-www-form-urlencoded'    accept = '*/*'    accept_encoding = 'gzip, deflate'    connection = 'keep-alive'    host = 'api.zhibugongzuo.com'    accept_language = 'zh-Hans-CN;q=1, en-CN;q=0.9'    headers = {        # 'Accept'       : accept,        'User-Agent'   : user_agent,        'Content-Type' : content_type,        # 'Accept-Encoding' : accept_encoding,        'Connection'   : connection,        'Host'         : host,        'Accept-Language' : accept_language,        'header_version':'3.6.3'    }    ## 1 login    url = "https://api.zhibugongzuo.com/v3_1/Login"    values = {}    values['password'] = password    values['username'] = username    data = urllib.urlencode(values)    request = urllib2.Request(url, data, headers)    response = urllib2.urlopen(request)    hjson = json.loads(response.read())    ## 2 userinfo    url = "https://api.zhibugongzuo.com/v3_1/User/UserInfo"    values = {}    values['token'] = hjson['token']    data = urllib.urlencode(values)    request = urllib2.Request(url, data, headers)    response = urllib2.urlopen(request)    ## 3 device insert    url = "http://api.zhibugongzuo.com/v3_1/Device/Insert"    values = {}    values['device_id'] = "037F1741-79C1-4527-9427-93E96D6A2077"    values['os_system'] = "iOS"    values['os_version'] = "8.3"    values['token'] = hjson['token']    values['type'] = 2    data = urllib.urlencode(values)    request = urllib2.Request(url, data, headers)    response = urllib2.urlopen(request)    ## app page    url = "http://api.zhibugongzuo.com/v3_1/App/Page"    values = {}    values['token'] = hjson['token']    request = urllib2.Request(url, data, headers)    response = urllib2.urlopen(request)    ## app news    url = "https://api.zhibugongzuo.com/v3_1/App/News"    request = urllib2.Request(url, data, headers)    response = urllib2.urlopen(request)    ## news list    url = "https://api.zhibugongzuo.com/v3_1/News/List"    values = {}    values['page_index'] = "1"    values['page_size'] = "20"    values['token'] = hjson['token']    values['type'] = "2"    data = urllib.urlencode(values)    request = urllib2.Request(url, data, headers)    response = urllib2.urlopen(request)    hjson1  = json.loads(response.read())    # 点击新闻并发表评论    news_cmt_list = ['改革，是永远不变对法宝', '跟进落实党的一贯政策！', '共同建设富强民主对新时代', '国家越来越富强，人民越来越富有', '祖国加油！', '振奋人心！！', '我们要把这样的精神贯彻落实到日常工作中！', '学习了！', '赞！', '关注！']    for id in range(10):        url = "https://api.zhibugongzuo.com/v3_1/News/Detail"        values = {}        values['id'] = hjson1['data'][id]['id']        values['token'] = hjson['token']        data = urllib.urlencode(values)        request = urllib2.Request(url, data, headers)        response = urllib2.urlopen(request)        # news cmtlist        url = "https://api.zhibugongzuo.com/v3_1/News/CmtList"        values = {}        values['id'] = hjson1['data'][id]['id']        values['page_index'] = "1"        values['page_size'] = "10"        values['token'] = hjson['token']        values['type'] = "1"        data = urllib.urlencode(values)        request = urllib2.Request(url, data, headers)        response = urllib2.urlopen(request)        # news affix        url = "https://api.zhibugongzuo.com/v3_1/News/NewsAffix"        values = {}        values['nid'] = hjson1['data'][id]['id']        values['token'] = hjson['token']        data = urllib.urlencode(values)        request = urllib2.Request(url, data, headers)        response = urllib2.urlopen(request)        # comment news        url = "https://api.zhibugongzuo.com/v3_1/News/CommentNews"        values = {}        values['comment'] = news_cmt_list[id]        values['id'] = hjson1['data'][id]['id']        values['re_uid'] = ""        values['rid'] = ""        values['token'] = hjson['token']        data = urllib.urlencode(values)        request = urllib2.Request(url, data, headers)        response = urllib2.urlopen(request)        news_cmt_response = json.loads(response.read())        print "新闻评论！返回码：",news_cmt_response['code'].encode("utf-8"),\              "提示信息：" , news_cmt_response['msg'].encode("utf-8")        time.sleep(30)    # 互动    # app inter    url = "https://api.zhibugongzuo.com/v3_1/App/Inter"    values = {}    values['token'] = hjson['token']    data = urllib.urlencode(values)    request = urllib2.Request(url, data, headers)    response = urllib2.urlopen(request)    # 互动广场:对两个问题进行回答，一个1分，2分满分    # help typelist    url = "https://api.zhibugongzuo.com/v3_1/Help/TypeList"    values = {}    values['token'] = hjson['token']    data = urllib.urlencode(values)    request = urllib2.Request(url, data, headers)    response = urllib2.urlopen(request)    # help list    url = 'https://api.zhibugongzuo.com/v3_1/Help/List'    values = {}    values['token'] = hjson['token']    values['page_size'] = 20    values['page_index'] = 1    values['type'] = 0    data = urllib.urlencode(values)    request = urllib2.Request(url, data, headers)    response = urllib2.urlopen(request)    help_list = json.loads(response.read())    for i in range(2):        # help detail        url = 'https://api.zhibugongzuo.com/v3_1/Help/Detail'        values = {}        values['token'] = hjson['token']        help_id = help_list['data'][random.randint(0, 19)]['id']        values['id'] = help_id        data = urllib.urlencode(values)        request = urllib2.Request(url, data, headers)        response = urllib2.urlopen(request)        # help getmorecmt        url = 'https://api.zhibugongzuo.com/v3_1/Help/GetMoreCmt'        values = {}        values['token'] = hjson['token']        values['id'] = help_id        values['page_size'] = 10        values['page_index'] = 1        values['type'] = 2        data = urllib.urlencode(values)        request = urllib2.Request(url, data, headers)        response = urllib2.urlopen(request)        help_cmt = json.loads(response.read())        # help postcomment        url = 'https://api.zhibugongzuo.com/v3_1/Help/PostComment'        values = {}        values['token'] = hjson['token']        values['id'] = help_id        values['re_uid'] = ''        values['rid'] = ''        help_cmt_len = len(help_cmt['data'])        values['content'] = help_cmt['data'][random.randint(0, help_cmt_len - 1)]['comment'].encode("utf-8")        data = urllib.urlencode(values)        request = urllib2.Request(url, data, headers)        response = urllib2.urlopen(request)        time.sleep(5)    # 党员视角:发布信息 一条信息2分，4分满分    # moments momentstype    url = "https://api.zhibugongzuo.com/v3_1/Moments/MomentsType"    values = {}    values['token'] = hjson['token']    data = urllib.urlencode(values)    request = urllib2.Request(url, data, headers)    response = urllib2.urlopen(request)    # moments commentnoread    url = "https://api.zhibugongzuo.com/v3_1/Moments/CommentNoread"    values = {}    values['token'] = hjson['token']    data = urllib.urlencode(values)    request = urllib2.Request(url, data, headers)    response = urllib2.urlopen(request)    for i in range(2):        # moment list        url = "https://api.zhibugongzuo.com/v3_1/Moments/List"        values = {}        values['page_size'] = 10        values['token'] = hjson['token']        data = urllib.urlencode(values)        request = urllib2.Request(url, data, headers)        response = urllib2.urlopen(request)        response_json = json.loads(response.read())        comment_content = response_json['data'][4]['content']        u = comment_content.encode("utf-8")        # prepare beforecreate        url = "https://api.zhibugongzuo.com/v3_1/Prepare/BeforeCreate"        values = {}        values['token'] = hjson['token']        values['type'] = 2        data = urllib.urlencode(values)        request = urllib2.Request(url, data, headers)        response = urllib2.urlopen(request)        # moments create        url = "https://api.zhibugongzuo.com/v3_1/Moments/Create"        values = {}        values['token'] = hjson['token']        values['type'] = ''        values['anon'] = 0        values['content'] = u        values['img'] = ''        values['img_type'] = ''        values['latitude'] = ''        values['limit_view'] = 1        values['location'] = ""        values['tags'] = 9        values['video'] = ""        values['video_thumb'] = ""        data = urllib.urlencode(values)        request = urllib2.Request(url, data, headers)        response = urllib2.urlopen(request)        comment_response = json.loads(response.read())        print "发布信息！返回码：",comment_response['code'].encode("utf-8"),\              "提示信息：",comment_response['msg']        time.sleep(3)    # 学习资料，体会满100字五分，满5分钟五分    # app study    url = "https://api.zhibugongzuo.com/v3_1/App/study"    values = {}    values['token'] = hjson['token']    data = urllib.urlencode(values)    request = urllib2.Request(url, data, headers)    response = urllib2.urlopen(request)    # study materialtypelist    url = "https://api.zhibugongzuo.com/v3_1/study/materialtypelist"    values = {}    values['token'] = hjson['token']    data = urllib.urlencode(values)    request = urllib2.Request(url, data, headers)    response = urllib2.urlopen(request)    material_typeid = json.loads(response.read())    # study materiallist    url = "https://api.zhibugongzuo.com/v3_1/study/materiallist"    values = {}    values['token'] = hjson['token']    values['page_index'] = 1    values['page_size'] = 20    values['type_id'] = material_typeid['data'][random.randint(0,3)]['type']    data = urllib.urlencode(values)    request = urllib2.Request(url, data, headers)    response = urllib2.urlopen(request)    material_id = json.loads(response.read())    mid = material_id['data'][random.randint(0,19)]['id']    # study getfeelingsnum    url = "https://api.zhibugongzuo.com/v3_1/study/getfeelingsnum"    values = {}    values['token'] = hjson['token']    values['mid'] = mid    data = urllib.urlencode(values)    request = urllib2.Request(url, data, headers)    response = urllib2.urlopen(request)    # login checktoken    url = "https://api.zhibugongzuo.com/v3_1/login/checktoken"    values = {}    values['token'] = hjson['token']    data = urllib.urlencode(values)    request = urllib2.Request(url, data, headers)    response = urllib2.urlopen(request)    # study checkcollstatus    url = "https://api.zhibugongzuo.com/v3_1/study/checkcollstatus"    values = {}    values['token'] = hjson['token']    values['mid'] = mid    data = urllib.urlencode(values)    request = urllib2.Request(url, data, headers)    response = urllib2.urlopen(request)    time.sleep(10)    # user noread    url = "https://api.zhibugongzuo.com/v3_1/user/noread"    values = {}    values['token'] = hjson['token']    data = urllib.urlencode(values)    request = urllib2.Request(url, data, headers)    response = urllib2.urlopen(request)    time.sleep(10)    feeling_content = ['新时代要有新气象，更要有新作为。中共十九大到二十大的5年，正处在实现“两个一百年”奋斗目标的历史交汇期，第一个百年目标要实现，第二个百年奋斗目标要开篇。这其中有一些重要的时间节点，是我们工作的坐标。也是我们工作努力的方向，要坚定不移的坚持。',                       '不忘初心，方得始终。中国共产党人的初心和使命，就是为中国人民谋幸福，为中华民族谋复兴。这个初心和使命是激励中国共产党人不断前进的根本动力。全党同志一定要永远与人民同呼吸、共命运、心连心，永远把人民对美好生活的向往作为奋斗目标，以永不懈怠的精神状态和一往无前的奋斗姿态，继续朝着实现中华民族伟大复兴的宏伟目标奋勇前进。',                       '五年来的成就是全方位的、开创性的，五年来的变革是深层次的、根本性的。五年来，我们党以巨大的政治勇气和强烈的责任担当，提出一系列新理念新思想新战略，出台一系列重大方针政策，推出一系列重大举措，推进一系列重大工作，解决了许多长期想解决而没有解决的难题，办成了许多过去想办而没有办成的大事，推动党和国家事业发生历史性变革。这些历史性变革，对党和国家事业发展具有重大而深远的影响',                       '五年来，我们勇于面对党面临的重大风险考验和党内存在的突出问题，以顽强意志品质正风肃纪、反腐惩恶，消除了党和国家内部存在的严重隐患，党内政治生活气象更新，党内政治生态明显好转，党的创造力、凝聚力、战斗力显著增强，党的团结统一更加巩固，党群关系明显改善，党在革命性锻造中更加坚强，焕发出新的强大生机活力，为党和国家事业发展提供了坚强政治保证。',                       '这个新时代，是承前启后、继往开来、在新的历史条件下继续夺取中国特色社会主义伟大胜利的时代，是决胜全面建成小康社会、进而全面建设社会主义现代化强国的时代，是全国各族人民团结奋斗、不断创造美好生活、逐步实现全体人民共同富裕的时代，是全体中华儿女勠力同心、奋力实现中华民族伟大复兴中国梦的时代，是我国日益走近世界舞台中央、不断为人类作出更大贡献的时代。']    # record feeling    url = "https://api.zhibugongzuo.com/v3_1/Study/RecordFeeling"    values = {}    values['content'] = feeling_content[random.randint(0,4)]    values['mid'] = mid    values['token'] = hjson['token']    data = urllib.urlencode(values)    request = urllib2.Request(url, data, headers)    response = urllib2.urlopen(request)    study_material_response = json.loads(response.read())    print "学习体会！返回码：",study_material_response['code'].encode("utf-8"),\          "提示信息：", study_material_response['msg'].encode("utf-8")    time.sleep(10)    # study readtime    url = "https://api.zhibugongzuo.com/v3_1/study/readtime"    values = {}    values['token'] = hjson['token']    values['mid'] = mid    values['time'] = random.randint(100, 312)    data = urllib.urlencode(values)    request = urllib2.Request(url, data, headers)    response = urllib2.urlopen(request)    study_time = json.loads(response.read())    print "学习时间！返回码：",study_time['code'].encode("utf-8"),\          "提示信息：", study_time['msg'].encode("utf-8")    returndict_user_info = {"lanwan29":"ngacn59631","zhangailing001":123456, "zhaoroujia":123456, "chengchengmumu":123456, "songxiaoxiao":"mt4426801219", "panwenzheng":123456789}print "running ",sys.argv[0]print "this time ,we handle", len(dict_user_info), "users"for key in dict_user_info:    print key    print dict_user_info[key]    crawler_beibei(dict_user_info[key], key)    time.sleep(10)